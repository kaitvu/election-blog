"0","# state sept polling prediction"
"0","state_2024 <- d_pollav_state |>"
"0","  filter(month(poll_date) == 9, "
"0","         party == ""DEM"", "
"0","         year == 2024) |>"
"0","  select(state, weeks_left, poll_date, poll_support) |>"
"0","  rename(sept_poll = poll_support)"
"0",""
"0","state_pred <- predict(state_reg, state_2024, interval = ""prediction"")"
"0",""
"0","predicted_2 <- state_pred[, ""fit""]"
"0","lb_2 <- state_pred[, ""lwr""]"
"0","ub_2 <- state_pred[, ""upr""]"
"0",""
"0","state_table <- state_2024 |>"
"0","  mutate(predicted_values = predicted_2,"
"0","         lower_bounds = lb_2,"
"0","         upper_bounds = ub_2) |>"
"0","  group_by(state) |>"
"0","  summarize(mean_prediction = round(weighted.mean(predicted_values, weeks_left, na.rm = TRUE),2), "
"0","            mean_lower_bound = round(weighted.mean(lower_bounds, weeks_left, na.rm = TRUE),2), "
"0","            mean_upper_bound = round(weighted.mean(upper_bounds, weeks_left, na.rm = TRUE),2)"
"0","            )"
"0",""
"0","state_table <- state_table |>"
"0","  mutate(winner = if_else(mean_prediction>50, ""Harris"", ""Trump""))"
"0",""
"0","# table 4: state sept polling model prediction (I used ChatGPT to format this table)"
"0","knitr::kable(state_table, "
"0","             col.names = c(""State"", ""Prediction"", ""Lower Bound"", ""Upper Bound"", ""Winner"")) |>"
"0","  kableExtra::kable_styling(full_width = FALSE) |>"
"0","  kableExtra::row_spec(row = which(state_table$winner == ""Harris""), background = ""#D3E5FF"") |>"
"0","  kableExtra::row_spec(row = which(state_table$winner == ""Trump""), background = ""#FFD1D1"")"
