"0","pv2p_2024_states <- d_pvstate_wide |>"
"0","  filter(year == 2020) |>"
"0","  group_by(state) |>"
"0","  summarize(R_pv2p_2024 = 0.75*R_pv2p + 0.25*R_pv2p_lag1, "
"0","            D_pv2p_2024 = 0.75*D_pv2p + 0.25*D_pv2p_lag1) |>"
"0","  mutate(pv2p_2024_margin = R_pv2p_2024 - D_pv2p_2024, "
"0","         winner = ifelse(R_pv2p_2024 > D_pv2p_2024, ""R"", ""D""), "
"0","         region = tolower(state))"
"0",""
"0","pv2p_2024_states |>"
"0","  left_join(states_map, by = ""region"") |>"
"0","  ggplot(aes(long, lat, group = group)) + "
"0","  geom_polygon(aes(fill = pv2p_2024_margin), color = ""black"") +"
"0","  scale_fill_gradient2(high = ""firebrick"", "
"0","                       low = ""dodgerblue4"", "
"0","                       mid = ""white"", "
"0","                       name = ""win margin"", "
"0","                       breaks = c(-50, -25, 0, 25, 50),  "
"0","                       limits = c(-50, 50)) +"
"0","  theme_void()"
