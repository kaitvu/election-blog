"0","# merge with state pv data"
"0","d_state_pv_2020 <- d_state_pv |> "
"0","  filter(year == 2020) |> "
"0","  mutate(R_pv2p = 100-D_pv2p) |>"
"0","  select(state, year, R_pv2p, D_pv2p) |> "
"0","  mutate(margin = D_pv2p - R_pv2p, "
"0","         winner = ifelse(D_pv2p > R_pv2p, ""D"", ""R""))"
"0","d_state_pv_2020[d_state_pv_2020$state == ""District Of Columbia"",]$state <- ""District of Columbia"""
"0",""
"0","d_expert <- d_expert |>"
"0","  left_join(d_state_pv_2020, by = ""state"") |>"
"0","  mutate(cook_correct = as.numeric((winner == ""D"" & cook_rating < 4) | "
"0","                                   (winner == ""R"" & cook_rating > 4)),"
"0","         sabato_correct = as.numeric((winner == ""D"" & sabato_rating < 4) | "
"0","                                     (winner == ""R"" & sabato_rating > 4))) |>"
"0","  drop_na()"
"0",""
"0","# table 6: expert correct table"
"0","correct_table <- d_expert |>"
"0","  select(cook_correct, sabato_correct) |> "
"0","  colMeans()"
"0",""
"0","correct_table <- as.data.frame(t(correct_table))"
"0","correct_table <- correct_table |>"
"0","  pivot_longer(cols = everything(), "
"0","               names_to = ""Model"", "
"0","               values_to = ""Percent Correct"") |>"
"0","  mutate(Model = recode(Model, "
"0","                        cook_correct = ""Cook Political Report"", "
"0","                        sabato_correct = ""Sabato's Crystal Ball""), "
"0","         `Percent Correct` = round(`Percent Correct`*100,2))"
"0",""
"0","knitr::kable(correct_table, "
"0","             col.names = c(""Model"", ""Percent Correct"")) |>"
"0","  kableExtra::kable_styling(full_width = FALSE)"
