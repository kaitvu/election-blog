dv.labels = "Republican's State-Level Popular Vote Share")
d_w3_24 <- d_pollav_state |>
filter(month(poll_date) == 9,
party == "DEM",
year == 2024) |>
select(state, weeks_left, poll_date, poll_support) |>
filter(state == c("Arizona", "Florida", "Georgia", "Michigan", "Minnesota", "Nevada", "New Hampshire", "New Mexico", "North Carolina", "Pennsylvania", "Texas", "Virginia", "Wisconsin")) |>
rename(sept_poll = poll_support)
r_w3_24 <- d_pollav_state |>
filter(month(poll_date) == 9,
party == "REP",
year == 2024) |>
select(state, weeks_left, poll_date, poll_support) |>
filter(state == c("Arizona", "Florida", "Georgia", "Michigan", "Minnesota", "Nevada", "New Hampshire", "New Mexico", "North Carolina", "Pennsylvania", "Texas", "Virginia", "Wisconsin")) |>
rename(sept_poll = poll_support)
d_w3_pred <- predict(d_w3_reg, d_w3_24, interval = "prediction")
r_w3_pred <- predict(r_w3_reg, r_w3_24, interval = "prediction")
View(r_w3_24)
View(r_w3_pred)
View(r_w3_24)
d_pollav_state |>
filter(month(poll_date) == 9,
party == "DEM",
year == 2024)
d_w3_24 <- d_pollav_state |>
filter(month(poll_date) == 9,
party == "DEM",
year == 2024) |>
select(state, weeks_left, poll_date, poll_support) |>
group_by(state) |>
rename(sept_poll = poll_support) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2)
View(d_w3_24)
d_w3_24 <- d_pollav_state |>
filter(month(poll_date) == 9,
party == "DEM",
year == 2024) |>
select(state, weeks_left, poll_date, poll_support) |>
group_by(state) |>
rename(sept_poll = poll_support) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2))
View(d_pollav_state)
d_w3_24 <- d_pollav_state |>
filter(month(poll_date) == 9,
party == "DEM",
year == 2024) |>
select(state, weeks_left, poll_date, poll_support) |>
group_by(state) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2))
View(d_w3_24)
d_w3_state_model <- d_pollav_state |>
select(year, state, weeks_left, poll_date, poll_support, party) |>
filter(month(poll_date) == 9,
party == "DEM",
year >= 2000) |>
group_by(year, state) |>
mutate(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2)) |>
left_join(d_state_pv, by = c("year", "state")) |>
select(year, state, sept_poll, D_pv2p) |>
drop_na()
r_w3_state_model <- d_pollav_state |>
select(year, state, weeks_left, poll_date, poll_support, party) |>
filter(month(poll_date) == 9,
party == "REP",
year >= 2000) |>
group_by(year, state) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2)) |>
left_join(d_state_pv, by = c("year", "state")) |>
select(year, state, sept_poll, R_pv2p) |>
drop_na()
d_w3_reg <- lm(D_pv2p ~ sept_poll,
data = d_w3_state_model)
r_w3_reg <- lm(R_pv2p ~ sept_poll,
data = r_w3_state_model)
tab_model(d_w3_reg, show.se = TRUE,
title = "Regression Table for State Sept. Polling (2020-2020)",
dv.labels = "Democrat's State-Level Popular Vote Share")
tab_model(r_w3_reg, show.se = TRUE,
title = "Regression Table for State Sept. Polling (2020-2020)",
dv.labels = "Republican's State-Level Popular Vote Share")
d_w3_24 <- d_pollav_state |>
filter(month(poll_date) == 9,
party == "DEM",
year == 2024) |>
select(state, weeks_left, poll_date, poll_support) |>
group_by(state) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2))
r_w3_24 <- d_pollav_state |>
filter(month(poll_date) == 9,
party == "REP",
year == 2024) |>
select(state, weeks_left, poll_date, poll_support) |>
group_by(state) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2))
d_w3_pred <- predict(d_w3_reg, d_w3_24, interval = "prediction")
r_w3_pred <- predict(r_w3_reg, r_w3_24, interval = "prediction")
View(r_w3_pred)
as.data.frame(d_w3_pred)
combined_predictions <- bind_cols(
as.data.frame(d_state_pred) |> rename_with(~paste0("D_", .)),
as.data.frame(r_state_pred) |> rename_with(~paste0("R_", .))
)
combined_predictions <- bind_cols(
as.data.frame(d_w3_pred) |> rename_with(~paste0("D_", .)),
as.data.frame(r_w3_pred) |> rename_with(~paste0("R_", .))
)
View(combined_predictions)
w3_table <- bind_cols(d_w3_24,
as.data.frame(d_w3_pred) |> rename_with(~paste0("D_", .)),
as.data.frame(r_w3_pred) |> rename_with(~paste0("R_", .))
)
View(w3_table)
w3_state_model <- d_pollav_state |>
select(year, state, weeks_left, poll_date, poll_support, party) |>
filter(month(poll_date) == 9,
party == "DEM",
year >= 2000) |>
group_by(year, state) |>
mutate(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2)) |>
left_join(d_state_pv, by = c("year", "state")) |>
select(year, state, sept_poll, D_pv2p) |>
drop_na()
w3_reg <- lm(D_pv2p ~ sept_poll,
data = w3_state_model)
tab_model(w3_reg, show.se = TRUE,
title = "Regression Table for State Sept. Polling (2020-2020)",
dv.labels = "Democrat's State-Level Popular Vote Share")
w3_24 <- d_pollav_state |>
filter(month(poll_date) == 9,
party == "DEM",
year == 2024) |>
select(state, weeks_left, poll_date, poll_support) |>
group_by(state) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2))
w3_pred <- predict(w3_reg, w3_24, interval = "prediction")
w3_table <- bind_cols(w3_24,
as.data.frame(w3_pred) |> rename_with(~paste0("D_", .)))
w3_state_model <- d_pollav_state |>
select(year, state, weeks_left, poll_date, poll_support, party) |>
filter(month(poll_date) == 9,
party == "DEM",
year >= 2000) |>
group_by(year, state) |>
mutate(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2)) |>
left_join(d_state_pv, by = c("year", "state")) |>
select(year, state, sept_poll, D_pv2p) |>
drop_na()
w3_reg <- lm(D_pv2p ~ sept_poll,
data = w3_state_model)
tab_model(w3_reg, show.se = TRUE,
title = "Regression Table for State Sept. Polling (2020-2020)",
dv.labels = "Democrat's State-Level Popular Vote Share")
w3_24 <- d_pollav_state |>
filter(month(poll_date) == 9,
party == "DEM",
year == 2024) |>
select(state, weeks_left, poll_date, poll_support) |>
group_by(state) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2))
w3_pred <- predict(w3_reg, w3_24, interval = "prediction")
w3_table <- bind_cols(w3_24,
as.data.frame(w3_pred) |> rename_with(~paste0("D_", .)))
w3_table
w3_state_model <- d_pollav_state |>
select(year, state, weeks_left, poll_date, poll_support, party) |>
filter(month(poll_date) == 9,
party == "DEM",
year >= 2000) |>
group_by(year, state) |>
mutate(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2)) |>
left_join(d_state_pv, by = c("year", "state")) |>
select(year, state, sept_poll, D_pv2p) |>
drop_na()
w3_reg <- lm(D_pv2p ~ sept_poll,
data = w3_state_model)
tab_model(w3_reg, show.se = TRUE,
title = "Regression Table for State Sept. Polling (2020-2020)",
dv.labels = "Democrat's State-Level Popular Vote Share")
w3_24 <- d_pollav_state |>
filter(month(poll_date) == 9,
party == "DEM",
year == 2024) |>
select(state, weeks_left, poll_date, poll_support) |>
group_by(state) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2))
w3_pred <- predict(w3_reg, w3_24, interval = "prediction")
w3_table <- bind_cols(w3_24,
as.data.frame(w3_pred) |> rename_with(~paste0("D_", .))) |>
mutate(D_fit = round(D_fit, 2),
D_lwr = round(D_lwr, 2),
D_upr = round(D_upr, 2)) |>
select(-sept_poll)
w3_table
w3_state_model <- d_pollav_state |>
select(year, state, weeks_left, poll_date, poll_support, party) |>
filter(month(poll_date) == 9,
party == "DEM",
year >= 2000) |>
group_by(year, state) |>
mutate(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2)) |>
left_join(d_state_pv, by = c("year", "state")) |>
select(year, state, sept_poll, D_pv2p) |>
drop_na()
w3_reg <- lm(D_pv2p ~ sept_poll,
data = w3_state_model)
tab_model(w3_reg, show.se = TRUE,
title = "Regression Table for State Sept. Polling (2020-2020)",
dv.labels = "Democrat's State-Level Popular Vote Share")
w3_24 <- d_pollav_state |>
filter(month(poll_date) == 9,
party == "DEM",
year == 2024) |>
select(state, weeks_left, poll_date, poll_support) |>
group_by(state) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2))
w3_pred <- predict(w3_reg, w3_24, interval = "prediction")
w3_table <- bind_cols(w3_24,
as.data.frame(w3_pred) |> rename_with(~paste0("D_", .))) |>
mutate(D_fit = round(D_fit, 2),
D_lwr = round(D_lwr, 2),
D_upr = round(D_upr, 2)) |>
select(-sept_poll) |>
filter(state == c("Arizona", "Florida", "Georgia", "Michigan", "Minnesota", "Nevada", "New Hampshire", "New Mexico", "North Carolina", "Pennsylvania", "Texas", "Virgina", "Wisconsin"))
w3_table
w3_state_model <- d_pollav_state |>
select(year, state, weeks_left, poll_date, poll_support, party) |>
filter(month(poll_date) == 9,
party == "DEM",
year >= 2000) |>
group_by(year, state) |>
mutate(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2)) |>
left_join(d_state_pv, by = c("year", "state")) |>
select(year, state, sept_poll, D_pv2p) |>
drop_na()
w3_reg <- lm(D_pv2p ~ sept_poll,
data = w3_state_model)
tab_model(w3_reg, show.se = TRUE,
title = "Regression Table for State Sept. Polling (2020-2020)",
dv.labels = "Democrat's State-Level Popular Vote Share")
w3_24 <- d_pollav_state |>
filter(month(poll_date) == 9,
party == "DEM",
year == 2024) |>
select(state, weeks_left, poll_date, poll_support) |>
group_by(state) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2))
w3_pred <- predict(w3_reg, w3_24, interval = "prediction")
w3_table <- bind_cols(w3_24,
as.data.frame(w3_pred) |> rename_with(~paste0("D_", .))) |>
mutate(D_fit = round(D_fit, 2),
D_lwr = round(D_lwr, 2),
D_upr = round(D_upr, 2)) |>
select(-sept_poll) |>
filter(state %in% c("Arizona", "Florida", "Georgia", "Michigan", "Minnesota", "Nevada", "New Hampshire", "New Mexico", "North Carolina", "Pennsylvania", "Texas", "Virgina", "Wisconsin"))
w3_table
w3_state_model <- d_pollav_state |>
select(year, state, weeks_left, poll_date, poll_support, party) |>
filter(month(poll_date) == 9,
party == "DEM",
year >= 2000) |>
group_by(year, state) |>
mutate(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2)) |>
left_join(d_state_pv, by = c("year", "state")) |>
select(year, state, sept_poll, D_pv2p) |>
drop_na()
w3_reg <- lm(D_pv2p ~ sept_poll,
data = w3_state_model)
tab_model(w3_reg, show.se = TRUE,
title = "Regression Table for State Sept. Polling (2020-2020)",
dv.labels = "Democrat's State-Level Popular Vote Share")
w3_24 <- d_pollav_state |>
filter(month(poll_date) == 9,
party == "DEM",
year == 2024) |>
select(state, weeks_left, poll_date, poll_support) |>
group_by(state) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2))
w3_pred <- predict(w3_reg, w3_24, interval = "prediction")
w3_table <- bind_cols(w3_24,
as.data.frame(w3_pred) |> rename_with(~paste0("D_", .))) |>
mutate(D_fit = round(D_fit, 2),
D_lwr = round(D_lwr, 2),
D_upr = round(D_upr, 2)) |>
select(-sept_poll) |>
filter(state %in% c("Arizona", "Florida", "Georgia", "Michigan", "Minnesota", "Nevada", "New Hampshire", "New Mexico", "North Carolina", "Pennsylvania", "Texas", "Virginia", "Wisconsin"))
w3_table
w3_state_model <- d_pollav_state |>
select(year, state, weeks_left, poll_date, poll_support, party) |>
filter(month(poll_date) == 9,
party == "DEM",
year >= 2000) |>
group_by(year, state) |>
mutate(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2)) |>
left_join(d_state_pv, by = c("year", "state")) |>
select(year, state, sept_poll, D_pv2p) |>
drop_na()
w3_reg <- lm(D_pv2p ~ sept_poll,
data = w3_state_model)
tab_model(w3_reg, show.se = TRUE,
title = "Regression Table for State Sept. Polling (2020-2020)",
dv.labels = "Democrat's State-Level Popular Vote Share")
w3_24 <- d_pollav_state |>
filter(month(poll_date) == 9,
party == "DEM",
year == 2024) |>
select(state, weeks_left, poll_date, poll_support) |>
group_by(state) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2))
w3_pred <- predict(w3_reg, w3_24, interval = "prediction")
w3_table <- bind_cols(w3_24,
as.data.frame(w3_pred) |> rename_with(~paste0("D_", .))) |>
mutate(D_fit = round(D_fit, 2),
D_lwr = round(D_lwr, 2),
D_upr = round(D_upr, 2),
winner = if_else(D_fit>50, "Harris", "Trump")) |>
select(-sept_poll) |>
filter(state %in% c("Arizona", "Florida", "Georgia", "Michigan", "Minnesota", "Nevada", "New Hampshire", "New Mexico", "North Carolina", "Pennsylvania", "Texas", "Virginia", "Wisconsin"))
knitr::kable(w3_table,
col.names = c("State", "Prediction", "Lower Bound", "Upper Bound", "Winner")) |>
kableExtra::kable_styling(full_width = FALSE) |>
kableExtra::row_spec(row = which(w3_table$winner == "Harris"), background = "#D3E5FF") |>
kableExtra::row_spec(row = which(w3_table$winner == "Trump"), background = "#FFD1D1")
w5_state_model <- d_pollav_state |>
select(year, state, weeks_left, poll_date, poll_support, party) |>
filter(month(poll_date) == 9,
party == "DEM",
year >= 2000) |>
group_by(year, state) |>
mutate(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2)) |>
left_join(d_state_pv, by = c("year", "state")) |>
select(year, state, sept_poll, D_pv2p) |>
drop_na() |>
left_join(demographics, by = c("year", "state"))
View(w5_state_model)
w5_state_model <- d_pollav_state |>
select(year, state, weeks_left, poll_date, poll_support, party) |>
filter(month(poll_date) == 9,
party == "DEM",
year >= 2000) |>
group_by(year, state) |>
mutate(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2)) |>
left_join(d_state_pv, by = c("year", "state")) |>
select(year, state, sept_poll, D_pv2p) |>
drop_na() |>
left_join(demographics, by = c("year", "state"))
w5_reg <- lm(D_pv2p ~ sept_poll + non_hispanic_white + african_american + hispanic + asian + native_american,
data = w5_state_model)
tab_model(w5_reg, show.se = TRUE,
title = "Regression Table for State Popular Vote Model (2020-2020)",
dv.labels = "Democrat's State-Level Popular Vote Share")
View(w5_state_model)
View(w3_state_model)
d_pollav_state |>
select(year, state, weeks_left, poll_date, poll_support, party) |>
filter(month(poll_date) == 9,
party == "DEM",
year >= 2000) |>
group_by(year, state) |>
mutate(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2))
w5_state_model <- d_pollav_state |>
select(year, state, weeks_left, poll_date, poll_support, party) |>
filter(month(poll_date) == 9,
party == "DEM",
year >= 2000) |>
group_by(year, state) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2)) |>
left_join(d_state_pv, by = c("year", "state")) |>
select(year, state, sept_poll, D_pv2p) |>
drop_na() |>
left_join(demographics, by = c("year", "state"))
w5_reg <- lm(D_pv2p ~ sept_poll + non_hispanic_white + african_american + hispanic + asian + native_american,
data = w5_state_model)
tab_model(w5_reg, show.se = TRUE,
title = "Regression Table for State Popular Vote Model (2020-2020)",
dv.labels = "Democrat's State-Level Popular Vote Share")
w3_state_model <- d_pollav_state |>
select(year, state, weeks_left, poll_date, poll_support, party) |>
filter(month(poll_date) == 9,
party == "DEM",
year >= 2000) |>
group_by(year, state) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2)) |>
left_join(d_state_pv, by = c("year", "state")) |>
select(year, state, sept_poll, D_pv2p) |>
drop_na()
w3_reg <- lm(D_pv2p ~ sept_poll,
data = w3_state_model)
tab_model(w3_reg, show.se = TRUE,
title = "Regression Table for State Sept. Polling (2020-2020)",
dv.labels = "Democrat's State-Level Popular Vote Share")
w3_24 <- d_pollav_state |>
filter(month(poll_date) == 9,
party == "DEM",
year == 2024) |>
select(state, weeks_left, poll_date, poll_support) |>
group_by(state) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2))
w3_pred <- predict(w3_reg, w3_24, interval = "prediction")
w3_table <- bind_cols(w3_24,
as.data.frame(w3_pred) |> rename_with(~paste0("D_", .))) |>
mutate(D_fit = round(D_fit, 2),
D_lwr = round(D_lwr, 2),
D_upr = round(D_upr, 2),
winner = if_else(D_fit>50, "Harris", "Trump")) |>
select(-sept_poll) |>
filter(state %in% c("Arizona", "Florida", "Georgia", "Michigan", "Minnesota", "Nevada", "New Hampshire", "New Mexico", "North Carolina", "Pennsylvania", "Texas", "Virginia", "Wisconsin"))
knitr::kable(w3_table,
col.names = c("State", "Prediction", "Lower Bound", "Upper Bound", "Winner")) |>
kableExtra::kable_styling(full_width = FALSE) |>
kableExtra::row_spec(row = which(w3_table$winner == "Harris"), background = "#D3E5FF") |>
kableExtra::row_spec(row = which(w3_table$winner == "Trump"), background = "#FFD1D1")
w5_state_model <- d_pollav_state |>
select(year, state, weeks_left, poll_date, poll_support, party) |>
filter(month(poll_date) == 9,
party == "DEM",
year >= 2000) |>
group_by(year, state) |>
summarize(sept_poll = round(weighted.mean(poll_support, weeks_left, na.rm = TRUE),2)) |>
left_join(d_state_pv, by = c("year", "state")) |>
select(year, state, sept_poll, D_pv2p) |>
drop_na() |>
left_join(demographics, by = c("year", "state"))
w5_reg <- lm(D_pv2p ~ sept_poll + non_hispanic_white + african_american + hispanic + asian + native_american,
data = w5_state_model)
tab_model(w5_reg, show.se = TRUE,
title = "Regression Table for State Popular Vote Model (2020-2020)",
dv.labels = "Democrat's State-Level Popular Vote Share")
w5_24 <- w3_24 |>
left_join(race_table, by = "state") |>
rename(african_american = `African-American`,
asian = Asian,
non_hispanic_white = `Non-Hispanic White`,
hispanic = Hispanic,
native_american = `Native American`) |>
select(-`Other Race`) |>
drop_na()
View(w5_reg)
View(w5_24)
w5_pred <- predict(w5_reg, w5_24, interval = "prediction")
View(w5_reg)
View(w5_24)
w5_24 <- w3_24 |>
left_join(race_table, by = "state") |>
rename(african_american = `African-American`,
asian = Asian,
non_hispanic_white = `Non-Hispanic White`,
hispanic = Hispanic,
native_american = `Native American`) |>
select(-`Other Race`) |>
drop_na()
w5_pred <- predict(w5_reg, w5_24, interval = "prediction")
w5_table <- bind_cols(w5_24,
as.data.frame(w5_pred) |> rename_with(~paste0("D_", .))) |>
mutate(D_fit = round(D_fit, 2),
D_lwr = round(D_lwr, 2),
D_upr = round(D_upr, 2),
winner = if_else(D_fit>50, "Harris", "Trump")) |>
select(-sept_poll) |>
filter(state %in% c("Arizona", "Florida", "Georgia", "Michigan", "Minnesota", "Nevada", "New Hampshire", "New Mexico", "North Carolina", "Pennsylvania", "Texas", "Virginia", "Wisconsin"))
knitr::kable(w5_table,
col.names = c("State", "Prediction", "Lower Bound", "Upper Bound", "Winner")) |>
kableExtra::kable_styling(full_width = FALSE) |>
kableExtra::row_spec(row = which(w5_table$winner == "Harris"), background = "#D3E5FF") |>
kableExtra::row_spec(row = which(w5_table$winner == "Trump"), background = "#FFD1D1")
View(w5_table)
View(w5_table)
w5_24 <- w3_24 |>
left_join(race_table, by = "state") |>
rename(african_american = `African-American`,
asian = Asian,
non_hispanic_white = `Non-Hispanic White`,
hispanic = Hispanic,
native_american = `Native American`) |>
select(-`Other Race`) |>
drop_na()
w5_pred <- predict(w5_reg, w5_24, interval = "prediction")
w5_table <- bind_cols(w5_24,
as.data.frame(w5_pred) |> rename_with(~paste0("D_", .))) |>
mutate(D_fit = round(D_fit, 2),
D_lwr = round(D_lwr, 2),
D_upr = round(D_upr, 2),
winner = if_else(D_fit>50, "Harris", "Trump")) |>
select(state, D_fit, D_lwr, D_upr, winner) |>
filter(state %in% c("Arizona", "Florida", "Georgia", "Michigan", "Minnesota", "Nevada", "New Hampshire", "New Mexico", "North Carolina", "Pennsylvania", "Texas", "Virginia", "Wisconsin")) |>
knitr::kable(w5_table,
col.names = c("State", "Prediction", "Lower Bound", "Upper Bound", "Winner")) |>
kableExtra::kable_styling(full_width = FALSE) |>
kableExtra::row_spec(row = which(w5_table$winner == "Harris"), background = "#D3E5FF") |>
kableExtra::row_spec(row = which(w5_table$winner == "Trump"), background = "#FFD1D1")
w5_24 <- w3_24 |>
left_join(race_table, by = "state") |>
rename(african_american = `African-American`,
asian = Asian,
non_hispanic_white = `Non-Hispanic White`,
hispanic = Hispanic,
native_american = `Native American`) |>
select(-`Other Race`) |>
drop_na()
w5_pred <- predict(w5_reg, w5_24, interval = "prediction")
w5_table <- bind_cols(w5_24,
as.data.frame(w5_pred) |> rename_with(~paste0("D_", .))) |>
mutate(D_fit = round(D_fit, 2),
D_lwr = round(D_lwr, 2),
D_upr = round(D_upr, 2),
winner = if_else(D_fit>50, "Harris", "Trump")) |>
filter(state %in% c("Arizona", "Florida", "Georgia", "Michigan", "Minnesota", "Nevada", "New Hampshire", "New Mexico", "North Carolina", "Pennsylvania", "Texas", "Virginia", "Wisconsin")) |>
select(state, D_fit, D_lwr, D_upr, winner)
knitr::kable(w5_table,
col.names = c("State", "Prediction", "Lower Bound", "Upper Bound", "Winner")) |>
kableExtra::kable_styling(full_width = FALSE) |>
kableExtra::row_spec(row = which(w5_table$winner == "Harris"), background = "#D3E5FF") |>
kableExtra::row_spec(row = which(w5_table$winner == "Trump"), background = "#FFD1D1")
